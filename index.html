<body>
  <h1>iNaturalist Observation Stats</h1>

  <div id="stats-container" style="display: flex; gap: 2rem;">
    <div id="deer-park" class="location-box" style="flex: 1;">
      <h2>ğŸ“ Deer Park Prairie</h2>
      <p id="deer-stats">Loading data...</p>
      <ul id="deer-list"></ul>
    </div>

    <div id="exploration-green" class="location-box" style="flex: 1;">
      <h2>ğŸ“ Exploration Green</h2>
      <p id="eg-stats">Loading data...</p>
      <ul id="eg-list"></ul>
    </div>
  </div>

  <script>
 async function loadObservationStats(placeId, statsId) {
  const url = `https://api.inaturalist.org/v1/observations?place_id=${placeId}`;
  try {
    console.log(`Fetching stats from: ${url}`);
    const response = await fetch(url);

    if (!response.ok) {
      throw new Error(`HTTP error! Status: ${response.status}`);
    }

    const data = await response.json();
    console.log("Received stats data:", data);

    const statsEl = document.getElementById(statsId);
    if (!statsEl) {
      console.warn(`Element with ID '${statsId}' not found`);
      return;
    }

    statsEl.textContent = `${data.total_results.toLocaleString()} total observations`;
  } catch (error) {
    console.error("Stats fetch failed:", error);
    const statsEl = document.getElementById(statsId);
    if (statsEl) {
      statsEl.textContent = "Failed to load observation count.";
    }
  }
}


    async function loadObservers(placeId, listId) {
      const url = `https://api.inaturalist.org/v1/observations/observers?place_id=${placeId}`;
      try {
        const response = await fetch(url);
        const data = await response.json();

        const listEl = document.getElementById(listId);
        listEl.innerHTML = "";

        data.results.forEach(observer => {
          const li = document.createElement("li");
          li.textContent = `${observer.user.login} â€” ${observer.observation_count} observations`;
          listEl.appendChild(li);
        });
      } catch (error) {
        console.error("Fetch failed:", error);
        document.getElementById(listId).innerHTML = "<li>Failed to load data.</li>";
      }
    }

    // Run all
    loadObservationStats(189476, "deer-stats");
    loadObservers(189476, "deer-list");

    loadObservationStats(120329, "eg-stats");
    loadObservers(120329, "eg-list");
  </script>
</body>
